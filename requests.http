###
# API Test File â€” Requires REST Client Extension
#
# Extension: "REST Client" by Huachao Mao
# https://marketplace.visualstudio.com/items?itemName=humao.rest-client
#
# How to use:
# - Install the extension above in VS Code
# - Click the "Send Request" text that appears above each request
###

@host = localhost
@port = 8000
@baseUrl = http://{{host}}:{{port}}

### =============================
### Confirm Payment - PIX (100%)
### =============================
POST {{baseUrl}}/api/v1/payments
Content-Type: application/json
Idempotency-Key: pix-100-percent-001

{
  "amount": "100.00",
  "currency": "BRL",
  "payment_method": "pix",
  "installments": 1,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 100
    }
  ]
}

### =====================================
### Confirm Payment - Card 3x (70 / 30)
### =====================================
POST {{baseUrl}}/api/v1/payments
Content-Type: application/json
Idempotency-Key: card-70-30-001

{
  "amount": "100.00",
  "currency": "BRL",
  "payment_method": "card",
  "installments": 3,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 70
    },
    {
      "recipient_id": "affiliate_1",
      "role": "affiliate",
      "percent": 30
    }
  ]
}

### =================================================
### Confirm Payment - Rounding Case (33 / 33 / 34)
### =================================================
POST {{baseUrl}}/api/v1/payments
Content-Type: application/json
Idempotency-Key: rounding-case-001

{
  "amount": "100.01",
  "currency": "BRL",
  "payment_method": "card",
  "installments": 1,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 33
    },
    {
      "recipient_id": "producer_2",
      "role": "producer",
      "percent": 33
    },
    {
      "recipient_id": "producer_3",
      "role": "producer",
      "percent": 34
    }
  ]
}

### =====================================
### Idempotency - Replay (same payload)
### =====================================
POST {{baseUrl}}/api/v1/payments
Content-Type: application/json
Idempotency-Key: card-70-30-001

{
  "amount": "100.00",
  "currency": "BRL",
  "payment_method": "card",
  "installments": 3,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 70
    },
    {
      "recipient_id": "affiliate_1",
      "role": "affiliate",
      "percent": 30
    }
  ]
}

### =====================================================
### Idempotency - Conflict (same key, different payload)
### =====================================================
POST {{baseUrl}}/api/v1/payments
Content-Type: application/json
Idempotency-Key: card-70-30-001

{
  "amount": "200.00",
  "currency": "BRL",
  "payment_method": "card",
  "installments": 3,
  "splits": [
    {
      "recipient_id": "seller_1",
      "role": "seller",
      "percent": 70
    },
    {
      "recipient_id": "platform",
      "role": "platform",
      "percent": 30
    }
  ]
}

### =========================
### Checkout Quote - PIX
### =========================
POST {{baseUrl}}/api/v1/checkout/quote
Content-Type: application/json

{
  "amount": "100.00",
  "currency": "BRL",
  "payment_method": "pix",
  "installments": 1,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 100
    }
  ]
}

### =========================
### Checkout Quote - Card 3x
### =========================
POST {{baseUrl}}/api/v1/checkout/quote
Content-Type: application/json

{
  "amount": "100.00",
  "currency": "BRL",
  "payment_method": "card",
  "installments": 3,
  "splits": [
    {
      "recipient_id": "producer_1",
      "role": "producer",
      "percent": 100
    }
  ]
}
